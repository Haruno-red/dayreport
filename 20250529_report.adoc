= Docker

== Dockerとは

* コンテナ型仮想環境を作成、実行、管理するためのプラットフォーム。 +
※ VirtualMachineでゲストOSを立ち上げるものをホスト型仮想環境という。

== Dockerのメリット

* 数秒～数十秒で素早くコンテナを起動し様々なアプリケーションを実行できる。
* 異なる環境でも簡単に同じ仮想環境を再現できるため、トラブルになりにくい。（開発で重宝）
* 仮想環境内でインストールするので元のPCの環境に影響がない。
* イメージのダウンロードやコンテナの作成が容易にできる。（ターミナル上で実行）

== Dockerの注意点

* ホストOSと同じコンテナしか起動できない。 +
※ LinuxコンテナはLinuxのホストOSのカーネル上でしか起動できない。
* 分離レベルが低いため、侵入されにくい設定や構成にする必要がある。
** 不用意にパブリックのネットワークにサーバを公開しない。
** 必要のないパッケージや脆弱性のあるライブラリをインストールしない。

== Dockerイメージとは

* コンテナ実行に必要なOSのライブラリやアプリケーション、設定などがまとめられたテンプレート。
* ダウンロードしたイメージを使用するだけでなく、特定のイメージをベースとしてカスタマイズできる。
* ストレージドライバとしてAUFSが採用されており、レイヤという階層構造でデータが管理される。
* Dockerイメージで作成されたレイヤは読み取り専用で、読み書き可能なコンテナレイヤとは区別されている。
* 不要なファイル作成を行わないなど、軽量なイメージ作りが必要。（サイズに注意）
    
== Docker Hubとは

* Dockerイメージのレジストリサービス。（Dockerイメージを管理する機能を提供するサービス）
* イメージの公開、検索、ダウンロードができる。（公式のものだけでなく個人のものも）
* イメージをダウンロードするのはリスクがあるので、作成元が信頼できるか確認してから実行するようにする。

.Trusted content
[options="header"]
|=======================
|ヘッダー　|内容
|Docker Official Image　|Docker社で脆弱性スキャンを実施しライブラリのガイドラインを満たした信頼性の高いイメージ
|Verified Publisher　|Docker社が検証済みの商用ベンダーが提供するイメージ
|Sponsored OSS　|Docker社がスポンサーとなっているオープンソースのイメージ
|=======================

セキュリティの面ではこの中からダウンロードするのがオススメ。

== イメージのタグ

* バージョンやディストリビューションごとに付けることが多い。
* イメージ名とタグ名を組み合わせることで様々なバージョンのイメージを提供できる。
* Dockerコマンドで引数のあとにタグ名を記述することで、特定のタグのイメージを指定することができる。 +
※ 記述がない場合は自動でlatestになる。
* 必ずしも最新のものがlatestとなっているわけではないことに注意。

== docker runコマンドを実行した際の動作

. Dockerデーモンに指示が送られる。
. DockerHubにDockerイメージを探しに行く。
. DockerHubからイメージがダウンロードされる。
. ダウンロードされたイメージを元にコンテナが起動される。
. あらかじめイメージに定義されているコマンドが実行される。
. 実行された結果が戻されてターミナル上に表示される。

docker runコマンドはdocker pull、create、startと、処理を分割することができる。

== その他

エイリアス :: 別名のこと。Windowsにおけるフォルダへのショートカットやコマンドの省略形などを指す。
